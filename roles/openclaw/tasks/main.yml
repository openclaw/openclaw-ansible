---
- name: Include system tools installation tasks
  ansible.builtin.include_tasks: system-tools.yml

- name: Include Tailscale installation tasks
  ansible.builtin.include_tasks: tailscale-linux.yml
  when: tailscale_enabled | bool

- name: Include user creation tasks
  ansible.builtin.include_tasks: user.yml

- name: Include Docker installation tasks
  ansible.builtin.include_tasks: docker-linux.yml
  when: not ci_test

- name: Include firewall configuration tasks
  ansible.builtin.include_tasks: firewall-linux.yml
  when: not ci_test

# Security hardening tasks
- name: Include SSH hardening tasks
  ansible.builtin.include_tasks: ssh-hardening.yml
  when: 
    - not ci_test
    - ssh_hardening_enabled | default(true) | bool

- name: Include kernel hardening tasks
  ansible.builtin.include_tasks: kernel-hardening.yml
  when:
    - not ci_test
    - kernel_hardening_enabled | default(true) | bool

- name: Include audit logging tasks
  ansible.builtin.include_tasks: audit-logging.yml
  when:
    - not ci_test
    - audit_logging_enabled | default(true) | bool

- name: Include Node.js installation tasks
  ansible.builtin.include_tasks: nodejs.yml

- name: Include OpenClaw setup tasks
  ansible.builtin.include_tasks: openclaw.yml
